---

- name: Deploy Semaphore UI
  hosts: semaphore,pgdb
  gather_facts: true
  become: true
  roles:
    - global
    - ansible_node
    - sshpass

  tasks:
    - name: Import venv.yml from python3 role
      ansible.builtin.import_role:
        name: python3
        tasks_from: venv.yml

    - name: Import ansible_setup role
      ansible.builtin.import_role:
        name: ansible_setup
      when: "'ansible' in group_names"

    - name: Include postgresql_setup role
      ansible.builtin.include_role:
        name: postgresql_setup
      when: "'pgdb' in group_names"

    - name: Import semaphoreui_setup role database task
      ansible.builtin.import_role:
        name: semaphoreui_setup
        tasks_from: database
      when: "'pgdb' in group_names"

    - name: Include semaphoreui_setup role
      ansible.builtin.include_role:
        name: semaphoreui_setup
      when: "'semaphore' in group_names"
