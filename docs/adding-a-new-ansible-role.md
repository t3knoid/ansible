# ðŸ‘©â€ðŸ’» Contributor Guide: Adding a New Ansible Role

## ðŸ“– Purpose
This guide explains how to add a new Ansible role to the homelab repository and ensure its documentation is automatically generated by our GitHub Action workflow.

---

## ðŸ›  Steps to Add a New Role

1. **Create the role folder**
   - Add a new directory under `roles/` with your role name:
     ```
     roles/my_new_role/
     ```

2. **Add required files**
   - At minimum, include:
     - `meta/main.yml` â†’ defines role metadata (name, description, author, license, supported platforms, dependencies).
     - `tasks/main.yml` â†’ defines tasks for the role.
     - `defaults/main.yml` â†’ optional, for default variables.
     - `vars/main.yml` â†’ optional, for constant variables.
     - `handlers/main.yml` â†’ optional, for handlers.

3. **Fill in metadata**
   - Example `meta/main.yml`:
     ```yaml
     galaxy_info:
       role_name: my_new_role
       author: Your Name
       description: Short description of what this role does.
       license: MIT
       min_ansible_version: "2.9"
       platforms:
         - name: Ubuntu
           versions:
             - focal
             - jammy
     dependencies: []
     ```

4. **Commit your changes**
   - Push your branch or open a pull request.

---

## âš™ï¸ What Happens Next
- The **Generate Ansible Role Docs** GitHub Action runs automatically on push/PR.
- It executes `scripts/generate_role_docs.py`, which:
  - Reads your `meta/main.yml`, `defaults`, `vars`, `tasks`, and `handlers`.
  - Generates a `README.md` inside your role folder.
  - Updates the central `roles/README.md` index with a link to your role.

---

## âœ… Contributor Expectations
- **No manual README writing needed** â†’ the script handles it.  
- **Keep metadata accurate** â†’ description, platforms, and dependencies drive the docs.  
- **Use comments in variable files** â†’ they appear in the generated tables.  
- **Check the PR diff** â†’ youâ€™ll see your roleâ€™s README and the index updated automatically.  

---

## ðŸš€ Example
After adding `roles/my_new_role/` and pushing, youâ€™ll see:

- `roles/my_new_role/README.md` â†’ auto-generated documentation.  
- `roles/README.md` â†’ updated index entry:  
  ```
  - [`my_new_role`](my_new_role/README.md): Short description of what this role does.
  ```

---

## ðŸ“‘ `meta/main.yml` Starter Template

```yaml
galaxy_info:
  role_name: my_new_role
  author: Your Name
  description: >
    Short description of what this role does.
    (Keep it concise but clear for auto-generated docs.)
  license: MIT
  min_ansible_version: "2.9"

  platforms:
    - name: Ubuntu
      versions:
        - focal
        - jammy
    - name: EL
      versions:
        - "7"
        - "8"

# List other roles this one depends on.
# These will be documented automatically in the README.
dependencies: []
```

---

### ðŸ”‘ Key Fields Explained
- **`role_name`** â†’ Must match the folder name under `roles/`.  
- **`author`** â†’ Contributorâ€™s name or team.  
- **`description`** â†’ Appears in the generated README and central index.  
- **`license`** â†’ License type (MIT, GPL, etc.).  
- **`min_ansible_version`** â†’ Minimum version required for the role.  
- **`platforms`** â†’ OS families and versions supported.  
- **`dependencies`** â†’ Other roles that must run before this one.  

---

### ðŸš€ Contributor Tip
- Keep descriptions short but meaningful â€” they show up in the **role index**.  
- Add dependencies if your role relies on another (e.g., `common`, `firewall`).  
- Update platforms whenever you test against new OS versions.  
