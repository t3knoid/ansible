---

- name: Install Python modules
  ansible.builtin.pip:
    name: "{{ item }}"
    virtualenv: "/opt/python_{{ python3_version }}"
    state: present
    umask: "0022"
  loop: "{{ ansible_setup_python_modules }}"

- name: Configure ansible callback plugins
  ansible.builtin.lineinfile:
    path: "{{ ansible_setup_config_path }}"
    regexp: '^;?callbacks_enabled\s*='
    line: "callbacks_enabled = {{ ansible_setup_callback_plugins | join(',') }}"
    # create: true
    state: present
    mode: "0664"
