---

- name: Install Ansible
  ansible.builtin.pip:
    name: ansible
    virtualenv: "/opt/python_{{ python3_version }}"
    state: present

- name: Install ansible-dev-tools (ansible-lint)
  ansible.builtin.pip:
    name: ansible-dev-tools
    virtualenv: "/opt/python_{{ python3_version }}"
    state: present

- name: Configure ansible callback plugins
  ansible.builtin.lineinfile:
    path: "{{ ansible_setup_config_path }}"
    regexp: '^;?callbacks_enabled\s*='
    line: "callbacks_enabled = {{ ansible_setup_callback_plugins }}"
    # create: true
    state: present
    mode: "0664"
